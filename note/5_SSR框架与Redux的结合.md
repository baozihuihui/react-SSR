# SSR 与 Redux 的结合

本章将讲解如何将 Redux 数据管理框架与 SSR 框架做结合，使 SSR 框架能够支撑复杂业务的开发。在这一章节中，我们将详细讲解服务器端异步数据获取的流程和方法，同时也给大家讲解清楚什么是同构中的数据脱水与注水。

## 中间层是什么

在客户端和底层获取数据服务端中间加入数据整合的服务器，向前返回 React-SSR 代码，向后端获取底层数据内容。

## Redux 加入

### 创建 store ，并解决 createStore 生成单例模式 store 的问题

### Redux 代码结构

### 生命周期以及 Hooks 不会在服务端进行执行。所以初始化数据需要特殊处理

1. 服务端接收到请求，这个时候 store 是空的
2. 服务器端代码不会执行生命周期，所以列表内容为空
3. 客户端代码运行，这个时候 store 依然是空的
4. 客户端执行服务器端不执行的生命周期，列表数据被获取
5. store 中的列表数据被更新
6. 客户端渲染出 store 中的 list 数据对应的列表内容

## React-Router-Dom load-data

- 服务器端需要在返回 html 之前，根据路由获取对应组件需要的异步数据。

## 数据的注水和脱水

- 注水：

  服务器端将 store 数据写入 html 文件

- 脱水：

  客户端读取 html 文件中对应 store，并作为 initState，合并到 store 上
